<!DOCTYPE html>
<html>
  <head>
    <title>Audité Audience</title>
    <script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
    <script src="http://www.parsecdn.com/js/parse-1.2.13.min.js"></script>
    <script src="https://cdn.pubnub.com/pubnub.min.js"></script>
    <script src="priv/js/parse-init.js"></script>
    <script src="priv/js/pubnub-init.js"></script>
  </head>
  <body>
    <h1>Audité Audience</h1>
    <div id="responses"></div>
  </body>
  <script src="js/audience.js"></script>
  <script>
    var Text = Parse.Object.extend("Text");

    var query = new Parse.Query(Text);

    query.equalTo("selected", true);

    query.descending("updatedAt");

    query.find({
      success: function(results) {
        for (var i = 0; i < results.length; i++) {
          addResponse(results[i], false);
        }
      },
      error: function(error) {
        alert("Error: " + error.code + " " + error.message);
      }
    });

    pubnub.subscribe({
        channel: 'audite-audience',
        message: function(message) {
                update(message)
            }
    });
  </script>
</html>
